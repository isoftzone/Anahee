import { DataTable, DataTableSortStatus } from 'mantine-datatable';
import { useEffect, useState } from 'react';
import sortBy from 'lodash/sortBy';
import { setPageTitle } from '../../store/themeConfigSlice';
import { useDispatch, useSelector } from 'react-redux';
import IconBell from '../../components/Icon/IconBell';
import IconFile from '../../components/Icon/IconFile';
import IconPrinter from '../../components/Icon/IconPrinter';
import { downloadExcel } from 'react-export-table-to-excel';
import Dropdown from '../../components/Dropdown';
import IconCaretDown from '../../components/Icon/IconCaretDown';
import { IRootState } from '../../store';
import { BASE_URL } from '../../config';
import axios, { AxiosResponse } from 'axios';
import '../../assets/css/tippy.css';
import { NavLink } from 'react-router-dom';
import IconCaretsDown from '../../components/Icon/IconCaretsDown';
import { toggleSidebar } from '../../store/themeConfigSlice';
import PerfectScrollbar from 'react-perfect-scrollbar';
import AnimateHeight from 'react-animate-height';
import IconMinus from '../Icon/IconMinus';


const StockReport = () => {
    const dispatch = useDispatch();
    useEffect(() => {
        dispatch(setPageTitle('Range Search Table'));
    });

    const [clientData, setClientData] = useState<UserData[]>([]);
    const [page, setPage] = useState(1);
    const themeConfig = useSelector((state: IRootState) => state.themeConfig);
    const semidark = useSelector((state: IRootState) => state.themeConfig.semidark);
    const PAGE_SIZES = [10, 20, 30, 50, 100];
    // const [pageSize, setPageSize] = useState(PAGE_SIZES[0]);
    const [initialRecords, setInitialRecords] = useState<UserData[]>([]);
    const [recordsData, setRecordsData] = useState(initialRecords);
    const [tempData, setTempData] = useState(initialRecords);
    const [search, setSearch] = useState('');
    const [currentPage, setCurrentPage] = useState<number>(1); // Explicitly specify type as number
    const [totalPages, setTotalPages] = useState<number>(1); // Explicitly specify type as number
    const [pageSize, setPageSize] = useState<number>(10); // Explicitly specify type as number
    const [totalRecords, setTotalRecords] = useState<number>(0);
    const [sortStatus, setSortStatus] = useState<DataTableSortStatus>({ columnAccessor: 'id', direction: 'asc' });
    const [selectedAgent, setSelectedAgent] = useState('');
    const [selectedFirm, setSelectedFirm] = useState('');
    const [selectedCity, setSelectedCity] = useState('');
    const [selectedState, setSelectedState] = useState('');
    const [selectedStatus, setSelectedStatus] = useState('');
    const [formDatas, setFormDatas] = useState([
        'BARCODE',
        'ITEMNAME',
        'ITEMID',
        'BOXSIZE',
        'HSNCODE',
        'RATE',
        'TAX',
        'PURPRICE',
        'MARKUP',
        'MRP',
        'MARKDOWN',
        'SALEPRICE',
        'EXPIRYDAYS',
        'LOOKUP',
        'REMARK',
        'PRODUCT',
        'BRAND',
        'SCOLOR',
        'COLOR',
        'I_SIZE',
        'STYLE',
        'SUBGROUP',
        'GENDER',
        'BUYER',
        'SUBCATEGORY',
        'CATEGORY',
        'MATERIAL',
        'COMPANY',
        'SEASON',
        'PACKING',
        'UNIT',
        'SECTION',
        'STATUS',
        'PHOTO',
    ]);

    interface UserData {
        id: number;
        COMPANYID: string;
        AGENTID: string;
        AFIRMNAME: string;
        ACTELEPHONENO: string;
        ACMOBILENO: string;
        ACADDRESSLINE1: string;
        ACADDRESSLINE2: string;
        ACADDRESSLINE3: string;
        STATUS: string;
        AGENTNAME: string;
        ADOB: number;
        APERSONALIDTYPE: string;
        APERSONALID: string;
        APMOBILENO: string;
        APEMAILID: string;
        APADDRESSLINE1: string;
        APADDRESSLINE2: string;
        APADDRESSLINE3: string;
        APCITY: string;
        APSTATE: string;
        APCOUNTRY: string;
        APDISTRICT: string;
        APPINCODE: string;
        ABANKNAME: string;
        AACCOUNTTYPE: string;
        AACCOUNTNO: string;
        AACCOUNTHOLDERNAME: string;
        ABRANCHNAME: string;
        AIFSCCODE: string;
        ACHEQUENO: string;
        ACHEQUEREMARK: string;
        AMICRCODE: string;
        ATPNOBANK: string;
        CREATEDBY: string;
        CREATEDON: string;
        UPDATEDBY: string;
        UPDATEDON: string;
        ACCITY: string;
        ACSTATE: string;
        ACCOUNTRY: string;
        ACDISTRICT: string;
        ACPINCODE: string;
        REMARK: string;
    }

    interface FormData {
        COMPANYID: any;
        AGENTID: any;
        AFIRMNAME: string;
        ACTELEPHONENO: string;
        ACMOBILENO: string;
        ACADDRESSLINE1: string;
        ACADDRESSLINE2: string;
        ACADDRESSLINE3: string;
        STATUS: string;
        AGENTNAME: string;
        ADOB: any;
        APERSONALIDTYPE: string;
        APERSONALID: string;
        APMOBILENO: string;
        APEMAILID: string;
        APADDRESSLINE1: string;
        APADDRESSLINE2: string;
        APADDRESSLINE3: string;
        APCITY: string;
        APSTATE: string;
        APCOUNTRY: string;
        APDISTRICT: string;
        APPINCODE: string;
        ABANKNAME: string;
        AACCOUNTTYPE: string;
        AACCOUNTNO: string;
        AACCOUNTHOLDERNAME: string;
        ABRANCHNAME: string;
        AIFSCCODE: string;
        ACHEQUENO: string;
        ACHEQUEREMARK: string;
        AMICRCODE: string;
        ATPNOBANK: string;
        CREATEDBY: string;
        CREATEDON: string;
        UPDATEDBY: string;
        UPDATEDON: string;
        ACCITY: string;
        ACSTATE: string;
        ACCOUNTRY: string;
        ACDISTRICT: string;
        ACPINCODE: string;
        REMARK: string;
    }

    const [formData, setFormData] = useState<FormData>({
        COMPANYID: '',
        AGENTID: '',
        AFIRMNAME: '',
        ACTELEPHONENO: '',
        ACMOBILENO: '',
        ACADDRESSLINE1: '',
        ACADDRESSLINE2: '',
        ACADDRESSLINE3: '',
        STATUS: '',
        AGENTNAME: '',
        ADOB: '',
        APERSONALIDTYPE: '',
        APERSONALID: '',
        APMOBILENO: '',
        APEMAILID: '',
        APADDRESSLINE1: '',
        APADDRESSLINE2: '',
        APADDRESSLINE3: '',
        APCITY: '',
        APSTATE: '',
        APCOUNTRY: '',
        APDISTRICT: '',
        APPINCODE: '',
        ABANKNAME: '',
        AACCOUNTTYPE: '',
        AACCOUNTNO: '',
        AACCOUNTHOLDERNAME: '',
        ABRANCHNAME: '',
        AIFSCCODE: '',
        ACHEQUENO: '',
        ACHEQUEREMARK: '',
        AMICRCODE: '',
        ATPNOBANK: '',
        CREATEDBY: '',
        CREATEDON: '',
        UPDATEDBY: '',
        UPDATEDON: '',
        ACCITY: '',
        ACSTATE: '',
        ACCOUNTRY: '',
        ACDISTRICT: '',
        ACPINCODE: '',
        REMARK: '',
    });

    useEffect(() => {
        if (window.innerWidth < 1024 && themeConfig.sidebar) {
            dispatch(toggleSidebar());
        }
        // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [location]);

    const handleDropdownChange = (event: React.ChangeEvent<HTMLSelectElement>) => {
        const { name, value } = event.target;
        if (name === 'Agent Name') {
            setSelectedAgent(value);
        } else if (name === 'Agent Firm Name') {
            setSelectedFirm(value);
        } else if (name === 'City') {
            setSelectedCity(value);
        } else if (name === 'State') {
            setSelectedState(value);
        } else if (name === 'Status') {
            setSelectedStatus(value);
        }
    };
    const handleSearch = () => {
        const filteredData = initialRecords.filter((record) => {
            return (
                (selectedAgent === '' || record.AGENTNAME === selectedAgent) &&
                (selectedFirm === '' || record.AFIRMNAME === selectedFirm) &&
                (selectedCity === '' || record.APCITY === selectedCity) &&
                (selectedState === '' || record.APSTATE === selectedState) &&
                (selectedStatus === '' || record.STATUS === selectedStatus)
            );
        });
        setRecordsData(filteredData);
    };

    const handleReset = () => {
        setSelectedAgent('');
        setSelectedFirm('');
        setSelectedCity('');
        setSelectedState('');
        setSelectedStatus('');
        setRecordsData(initialRecords.slice(0, 10));
    };

    useEffect(() => {
        setPage(1);
    }, [pageSize]);

    useEffect(() => {
        fetch(`${BASE_URL}/getMaster`)
            .then((response) => response.json())
            .then((data) => {
                let detail = data;
                setClientData(detail);
                setInitialRecords(data);
                setRecordsData(data);
                setTempData(data);
            })
            .catch((error) => {
                console.error('Error fetching data:', error);
            });
    }, []);

    interface ApiResponse {
        totalRecords: number;
        totalPages: number;
        currentPage: number;
        agents: UserData[];
    }

    useEffect(() => {
        // Function to fetch data from the API
        const fetchData = async () => {
            try {
                const response: AxiosResponse<ApiResponse> = await axios.get(`${BASE_URL}/getMasterPagination?page=${currentPage}`);
                console.log(currentPage, 'aaaaaaa');
                const { totalRecords, totalPages, currentPage: fetchedCurrentPage, agents } = response.data;
                setInitialRecords(agents);
                setRecordsData(agents);
                setTempData(agents);
                setTotalPages(totalPages);
                setCurrentPage(fetchedCurrentPage);
                setTotalRecords(totalRecords);
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        };

        fetchData(); // Fetch data when the component mounts or currentPage changes
    }, [currentPage]);

    useEffect(() => {
        const from = (page - 1) * pageSize;
        const to = from + pageSize;
        setRecordsData([...initialRecords.slice(from, to)]);
    }, [page, pageSize, initialRecords]);

    useEffect(() => {
        setInitialRecords(() => {
            return tempData.filter((item) => {
                return (
                    item.id.toString().includes(search.toLowerCase()) ||
                    item.AGENTNAME.toLowerCase().includes(search.toLowerCase()) ||
                    item.AFIRMNAME.toLowerCase().includes(search.toLowerCase()) ||
                    item.APCOUNTRY.toLowerCase().includes(search.toLowerCase()) ||
                    item.APEMAILID.toLowerCase().includes(search.toLowerCase()) ||
                    item.ACADDRESSLINE1.toString().toLowerCase().includes(search.toLowerCase()) ||
                    item.APCITY.toLowerCase().includes(search.toLowerCase()) ||
                    item.APMOBILENO.toLowerCase().includes(search.toLowerCase())
                );
            });
        });
    }, [search]);

    useEffect(() => {
        const data = sortBy(initialRecords, sortStatus.columnAccessor);
        setInitialRecords(sortStatus.direction === 'desc' ? data.reverse() : data);
        setPage(1);
    }, [sortStatus]);

    // const [minAge, setMinAge] = useState<any>('');
    // const [maxAge, setMaxAge] = useState<any>('');

    // useEffect(() => {
    //     let dt = rowData;
    //     if (minAge !== '' && minAge !== null) {
    //         dt = dt.filter((d) => d.age >= Number(minAge));
    //     }
    //     if (maxAge !== '' && maxAge !== null) {
    //         dt = dt.filter((d) => d.age <= Number(maxAge));
    //     }
    //     if (minAge || maxAge) {
    //         setInitialRecords(dt);
    //         setTempData(dt);
    //     }
    // }, [minAge, maxAge]);

    const formatDate = (date: any) => {
        if (date) {
            const dt = new Date(date);
            const month = dt.getMonth() + 1 < 10 ? '0' + (dt.getMonth() + 1) : dt.getMonth() + 1;
            const day = dt.getDate() < 10 ? '0' + dt.getDate() : dt.getDate();
            return day + '/' + month + '/' + dt.getFullYear();
        }
        return '';
    };

    const col = ['id', 'agentName', 'agentFirmName', 'company', 'age', 'dob', 'email', 'phone'];
    const header = [
        'id',
        'COMPANYID',
        'AGENTID',
        'AFIRMNAME',
        'ACTELEPHONENO',
        'ACMOBILENO',
        'ACADDRESSLINE1',
        'STATUS',
        'AGENTNAME',
        'ADOB',
        'APERSONALIDTYPE',
        'APERSONALID',
        'APMOBILENO',
        'APEMAILID',
        'APADDRESSLINE1',
        'APCITY',
        'APSTATE',
        'APCOUNTRY',
        'APDISTRICT',
        'APPINCODE',
        'ABANKNAME',
        'AACCOUNTTYPE',
        'AACCOUNTNO',
        'AACCOUNTHOLDERNAME',
        'ABRANCHNAME',
        'AIFSCCODE',
        'ACHEQUENO',
        'ACHEQUEREMARK',
        'AMICRCODE',
        'ATPNOBANK',
        'CREATEDBY',
        'CREATEDON',
        'UPDATEDBY',
        'UPDATEDBY',
        'UPDATEDON',
        'ACCITY',
        'ACCOUNTRY',
        'ACDISTRICT',
        'ACPINCODE',
        'Remark',
    ];

    const exportTable = (type: any) => {
        let columns: any = header;
        let records = initialRecords;
        let filename = 'table';

        let newVariable: any;
        newVariable = window.navigator;

        if (type === 'csv') {
            let coldelimiter = ';';
            let linedelimiter = '\n';
            let result = columns
                .map((d: any) => {
                    return capitalize(d);
                })
                .join(coldelimiter);
            result += linedelimiter;
            // eslint-disable-next-line array-callback-return
            records.map((item: any) => {
                // eslint-disable-next-line array-callback-return
                columns.map((d: any, index: any) => {
                    if (index > 0) {
                        result += coldelimiter;
                    }
                    let val = item[d] ? item[d] : '';
                    result += val;
                });
                result += linedelimiter;
            });

            if (result == null) return;
            if (!result.match(/^data:text\/csv/i) && !newVariable.msSaveOrOpenBlob) {
                var data = 'data:application/csv;charset=utf-8,' + encodeURIComponent(result);
                var link = document.createElement('a');
                link.setAttribute('href', data);
                link.setAttribute('download', filename + '.csv');
                link.click();
            } else {
                var blob = new Blob([result]);
                if (newVariable.msSaveOrOpenBlob) {
                    newVariable.msSaveBlob(blob, filename + '.csv');
                }
            }
        } else if (type === 'print') {
            var rowhtml = '<p>' + filename + '</p>';
            rowhtml +=
                '<table style="width: 100%; " cellpadding="0" cellcpacing="0"><thead><tr style="color: #515365; background: #eff5ff; -webkit-print-color-adjust: exact; print-color-adjust: exact; "> ';
            // eslint-disable-next-line array-callback-return
            columns.map((d: any) => {
                rowhtml += '<th>' + capitalize(d) + '</th>';
            });
            rowhtml += '</tr></thead>';
            rowhtml += '<tbody>';

            // eslint-disable-next-line array-callback-return
            records.map((item: any) => {
                rowhtml += '<tr>';
                // eslint-disable-next-line array-callback-return
                columns.map((d: any) => {
                    let val = item[d] ? item[d] : '';
                    rowhtml += '<td>' + val + '</td>';
                });
                rowhtml += '</tr>';
            });
            rowhtml +=
                '<style>body {font-family:Arial; color:#495057;}p{text-align:center;font-size:18px;font-weight:bold;margin:15px;}table{ border-collapse: collapse; border-spacing: 0; }th,td{font-size:12px;text-align:left;padding: 4px;}th{padding:8px 4px;}tr:nth-child(2n-1){background:#f7f7f7; }</style>';
            rowhtml += '</tbody></table>';
            var winPrint: any = window.open('', '', 'left=0,top=0,width=1000,height=600,toolbar=0,scrollbars=0,status=0');
            winPrint.document.write('<title>Print</title>' + rowhtml);
            winPrint.document.close();
            winPrint.focus();
            winPrint.print();
        } else if (type === 'txt') {
            let coldelimiter = ',';
            let linedelimiter = '\n';
            let result = columns
                .map((d: any) => {
                    return capitalize(d);
                })
                .join(coldelimiter);
            result += linedelimiter;
            // eslint-disable-next-line array-callback-return
            records.map((item: any) => {
                // eslint-disable-next-line array-callback-return
                columns.map((d: any, index: any) => {
                    if (index > 0) {
                        result += coldelimiter;
                    }
                    let val = item[d] ? item[d] : '';
                    result += val;
                });
                result += linedelimiter;
            });

            if (result == null) return;
            if (!result.match(/^data:text\/txt/i) && !newVariable.msSaveOrOpenBlob) {
                var data1 = 'data:application/txt;charset=utf-8,' + encodeURIComponent(result);
                var link1 = document.createElement('a');
                link1.setAttribute('href', data1);
                link1.setAttribute('download', filename + '.txt');
                link1.click();
            } else {
                var blob1 = new Blob([result]);
                if (newVariable.msSaveOrOpenBlob) {
                    newVariable.msSaveBlob(blob1, filename + '.txt');
                }
            }
        }
    };

    function handleDownloadExcel() {
        const col: Array<keyof UserData> = [
            'id',
            'COMPANYID',
            'AGENTID',
            'AFIRMNAME',
            'ACTELEPHONENO',
            'ACMOBILENO',
            'ACADDRESSLINE1',
            'STATUS',
            'AGENTNAME',
            'ADOB',
            'APERSONALIDTYPE',
            'APERSONALID',
            'APMOBILENO',
            'APEMAILID',
            'APADDRESSLINE1',
            'APCITY',
            'APSTATE',
            'APCOUNTRY',
            'APDISTRICT',
            'APPINCODE',
            'ABANKNAME',
            'AACCOUNTTYPE',
            'AACCOUNTNO',
            'AACCOUNTHOLDERNAME',
            'ABRANCHNAME',
            'AIFSCCODE',
            'ACHEQUENO',
            'ACHEQUEREMARK',
            'AMICRCODE',
            'ATPNOBANK',
            'CREATEDBY',
            'CREATEDON',
            'UPDATEDBY',
            'UPDATEDBY',
            'UPDATEDON',
            'ACCITY',
            'ACCOUNTRY',
            'ACDISTRICT',
            'ACPINCODE',
            'REMARK',
        ];
        downloadExcel({
            fileName: 'table',
            sheet: 'react-export-table-to-excel',
            tablePayload: {
                header,
                body: recordsData.map((row) => col.map((key) => row[key])),
            },
        });
    }

    const capitalize = (text: any) => {
        return text
            .replace('_', ' ')
            .replace('-', ' ')
            .toLowerCase()
            .split(' ')
            .map((s: any) => s.charAt(0).toUpperCase() + s.substring(1))
            .join(' ');
    };

    useEffect(() => {
        dispatch(setPageTitle('Column Chooser Table'));
    });
    const isRtl = useSelector((state: IRootState) => state.themeConfig.rtlClass) === 'rtl' ? true : false;

    // show/hide
    const [hideCols, setHideCols] = useState<any>([
        'age',
        'dob',
        'COMPANYID',
        'AGENTID',
        'ACTELEPHONENO',
        'ACMOBILENO',
        'ACADDRESSLINE1',
        'STATUS',
        'ADOB',
        'APERSONALIDTYPE',
        'APERSONALID',
        'APMOBILENO',
        'APADDRESSLINE1',
        'APCITY',
        'APSTATE',
        'APCOUNTRY',
        'APDISTRICT',
        'APPINCODE',
        'ABANKNAME',
        'AACCOUNTTYPE',
        'AACCOUNTNO',
        'AACCOUNTHOLDERNAME',
        'ABRANCHNAME',
        'AIFSCCODE',
        'ACHEQUENO',
        'ACHEQUEREMARK',
        'AMICRCODE',
        'ATPNOBANK',
        'CREATEDBY',
        'CREATEDON',
        'UPDATEDBY',
        'UPDATEDBY',
        'UPDATEDON',
        'ACCITY',
        'ACCOUNTRY',
        'ACDISTRICT',
        'ACPINCODE',
        'ACSTATE',
        'Remark',
        'isActive',
    ]);

    const showHideColumns = (col: any, value: any) => {
        if (hideCols.includes(col)) {
            setHideCols((col: any) => hideCols.filter((d: any) => d !== col));
        } else {
            setHideCols([...hideCols, col]);
        }
    };

    const cols = [
        { accessor: 'id', title: 'ID' },
        { accessor: 'agentName', title: 'Agent Name' },
        { accessor: 'agentFirmName', title: 'Agent Firm Name' },
        { accessor: 'email', title: 'Email' },
        { accessor: 'dob', title: 'Startdate' },
        { accessor: 'phone', title: 'Phone' },
        { accessor: 'age', title: 'Status' },
        { accessor: 'Remark', title: 'Remark' },
        { accessor: 'AACCOUNTHOLDERNAME', title: 'Account Holder Name' },
        { accessor: 'AACCOUNTNO', title: 'Account No' },
        { accessor: 'AACCOUNTTYPE', title: 'Account Type' },
        { accessor: 'ABANKNAME', title: 'Bank Name' },
        { accessor: 'ABRANCHNAME', title: 'Branch Name' },
        { accessor: 'ACADDRESSLINE1', title: 'Company Address' },
        { accessor: 'ACCITY', title: 'Company City' },
        { accessor: 'ACCOUNTRY', title: 'Company Country' },
        { accessor: 'ACDISTRICT', title: 'Company District' },
        { accessor: 'ACHEQUENO', title: 'Cheque No' },
        { accessor: 'ACHEQUEREMARK', title: 'Cheque Mark' },
        { accessor: 'ACMOBILENO', title: 'Company Contact No' },
        { accessor: 'ACPINCODE', title: 'Company Pincode' },
        { accessor: 'ACSTATE', title: 'Company State' },
        { accessor: 'ACTELEPHONENO', title: 'Company Telephone' },
        { accessor: 'AIFSCCODE', title: 'IFSC Code' },
        { accessor: 'AMICRCODE', title: 'MICR Code' },
        { accessor: 'APADDRESSLINE1', title: 'Agent Address' },
        { accessor: 'APCITY', title: 'City' },
        { accessor: 'APDISTRICT', title: 'District' },
        { accessor: 'APERSONALIDTYPE', title: 'Agent ID Type' },
        { accessor: 'APERSONALID', title: 'Agent ID No' },
        { accessor: 'APMOBILENO', title: 'Personal Contact No' },
        { accessor: 'APPINCODE', title: 'Agent Pincode' },
        { accessor: 'APSTATE', title: 'Agent State' },
        { accessor: 'ATPNOBANK', title: 'Bank ATP No' },
    ];

    useEffect(() => {
        setPage(1);
    }, [pageSize]);

    useEffect(() => {
        const from = (page - 1) * pageSize;
        const to = from + pageSize;
        setRecordsData([...initialRecords.slice(from, to)]);
    }, [page, pageSize, initialRecords]);

    // useEffect(() => {
    //     setInitialRecords(() => {
    //         return rowData.filter((item) => {
    //             return (
    //                 item.id.toString().includes(search.toLowerCase()) ||
    //                 item.agentName.toLowerCase().includes(search.toLowerCase()) ||
    //                 item.agentFirmName.toLowerCase().includes(search.toLowerCase()) ||
    //                 item.company.toLowerCase().includes(search.toLowerCase()) ||
    //                 item.email.toLowerCase().includes(search.toLowerCase()) ||
    //                 item.age.toString().toLowerCase().includes(search.toLowerCase()) ||
    //                 item.dob.toLowerCase().includes(search.toLowerCase()) ||
    //                 item.phone.toLowerCase().includes(search.toLowerCase())
    //             );
    //         });
    //     });
    //     // eslint-disable-next-line react-hooks/exhaustive-deps
    // }, [search]);

    const IconMenuDashboard = () => <div>Dashboard Icon</div>;
const IconMenuTables = () => <div>Tables Icon</div>;

const dispatch = useDispatch();
    const [currentMenu, setCurrentMenu] = useState('');
    const [errorSubMenu, setErrorSubMenu] = useState(false);
    
    // State for submenus (add more as needed)
    const [basicSubMenuOpen, setBasicSubMenuOpen] = useState(false);
    const [purchaseSubMenuOpen, setPurchaseSubMenuOpen] = useState(false);
    
    const toggleMenu = (value) => {
        setCurrentMenu((oldValue) => {
            return oldValue === value ? '' : value;
        });
    };

    const semidark = useSelector((state) => state.themeConfig.semidark);


    return (
        <div>
            <div className="panel">
                <div className="flex flex-btn md:items-center justify-end ms-5 ps-5 md:flex-row flex-col mb-4.5 gap-1">
                    <div className="flex  items-center ">
                        <button type="button" onClick={() => exportTable('csv')} className="btn btn-primary btn-sm m-1 ">
                            <IconFile className=" nav-btn w-5 h-5 ltr:mr-1 rtl:ml-1" />
                            CSV
                        </button>
                        <button type="button" onClick={() => exportTable('txt')} className="btn btn-primary btn-sm m-1">
                            <IconFile className="nav-btn w-5 h-5 ltr:mr-2 rtl:ml-2" />
                            TXT
                        </button>

                        <button type="button" className="btn btn-primary btn-sm m-1" onClick={handleDownloadExcel}>
                            <IconFile className="nav-btn w-5 h-5 ltr:mr-2 rtl:ml-2" />
                            EXCEL
                        </button>

                        <button type="button" onClick={() => exportTable('print')} className="btn btn-primary btn-sm m-1">
                            <IconPrinter className="nav-btn w-5 h-5 ltr:mr-2 rtl:ml-2" />
                            PRINT
                        </button>
                        <button type="button" className="nav-btn btn btn-primary m-1" style={{
                            width: '12%',
                            height: '34px',
                            fontSize:'12px'
                        }}>
                            RESET
                        </button>
                        <button type="button" className=" nav-btn btn btn-primary m-1" style={{
                            width: '12%',
                            height: '34px',
                            fontSize:'12px'
                        }}>
                            SEARCH
                        </button>
                        {/* <button
                        type="button"
                        className="btn btn-primary btn-sm m-1 w-5 h-5 ltr:mr-2 rtl:ml-2"
                        style={{
                            width: '8%',
                            height: '34px',
                        }}
                        onClick={handleReset}
                    >
                        Reset
                    </button>
                    <button
                        type="button"
                        className="btn btn-primary btn-sm m-1 w-50 h-5 ltr:mr-2 rtl:ml-2"
                        style={{
                            width: '8%',
                            height: '34px',
                        }}
                        onClick={handleSearch}
                    >
                        Search
                    </button> */}
                    </div>
                   
                    <div className="flex md:items-center md:flex-row flex-col  gap-1">
                        <div className="flex items-center gap-5 ltr:ml-auto rtl:mr-auto">
                            <div className="flex md:items-center md:flex-row flex-col gap-1">
                                <div className="dropdown">
                                    <Dropdown
                                        placement={`${isRtl ? 'bottom-end' : 'bottom-start'}`}
                                        btnClassName="!flex items-center border font-semibold border-white-light dark:border-[#253b5c] rounded-md px-4 py-2 text-sm dark:bg-[#1b2e4b] dark:text-white-dark"
                                        button={
                                            <>
                                                <span className="ltr:mr-1 rtl:ml-1">Columns</span>
                                                <IconCaretDown className="w-5 h-5" />
                                            </>
                                        }
                                    >
                                        <div className="overflow-auto max-h-[300px]">
                                            <ul className="!min-w-[140px]">
                                                {cols.map((col, i) => {
                                                    if (i % 3 === 0) {
                                                        return (
                                                            <li
                                                                key={i}
                                                                className="flex md:flex-row flex-col "
                                                                onClick={(e) => {
                                                                    e.stopPropagation();
                                                                }}
                                                            >
                                                                <div className="flex items-center px-4 py-1 md:w-1/3">
                                                                    <label className="cursor-pointer mb-0 flex items-center">
                                                                        <input
                                                                            type="checkbox"
                                                                            checked={!hideCols.includes(col.accessor)}
                                                                            className="form-checkbox mr-2"
                                                                            defaultValue={col.accessor}
                                                                            onChange={(event) => {
                                                                                setHideCols(event.target.value);
                                                                                showHideColumns(col.accessor, event.target.checked);
                                                                            }}
                                                                        />
                                                                        <span>{col.title}</span>
                                                                    </label>
                                                                </div>
                                                                {cols[i + 1] && (
                                                                    <div className="flex items-center px-4 py-1 md:w-1/3">
                                                                        <label className="cursor-pointer mb-0 flex items-center">
                                                                            <input
                                                                                type="checkbox"
                                                                                checked={!hideCols.includes(cols[i + 1].accessor)}
                                                                                className="form-checkbox mr-2"
                                                                                defaultValue={cols[i + 1].accessor}
                                                                                onChange={(event) => {
                                                                                    setHideCols(event.target.value);
                                                                                    showHideColumns(cols[i + 1].accessor, event.target.checked);
                                                                                }}
                                                                            />
                                                                            <span>{cols[i + 1].title}</span>
                                                                        </label>
                                                                    </div>
                                                                )}
                                                                {cols[i + 2] && (
                                                                    <div className="flex items-center px-4 py-1 md:w-1/3">
                                                                        <label className="cursor-pointer mb-0 flex items-center">
                                                                            <input
                                                                                type="checkbox"
                                                                                checked={!hideCols.includes(cols[i + 2].accessor)}
                                                                                className="form-checkbox mr-2"
                                                                                defaultValue={cols[i + 2].accessor}
                                                                                onChange={(event) => {
                                                                                    setHideCols(event.target.value);
                                                                                    showHideColumns(cols[i + 2].accessor, event.target.checked);
                                                                                }}
                                                                            />
                                                                            <span>{cols[i + 2].title}</span>
                                                                        </label>
                                                                    </div>
                                                                )}
                                                            </li>
                                                        );
                                                    } else {
                                                        return null;
                                                    }
                                                })}
                                            </ul>
                                        </div>
                                    </Dropdown>
                                </div>
                            </div>
                        </div>
                    </div>

                    <input type="text" className="form-input w-25 " placeholder="Search..." value={search} onChange={(e) => setSearch(e.target.value)} />
                </div>
                {/* <div className="mb-4.5 flex md:items-center md:flex-row flex-col gap-5">
                    <div className="flex items-center gap-5">
                        <div className="md:flex-auto flex-1">
                            <input
                                type="text"
                                value={minAge}
                                onChange={(e) => {
                                    setMinAge(e.target.value);
                                }}
                                className="form-input"
                                placeholder="Minimum age..."
                            />
                        </div>
                        <div className="md:flex-auto flex-1">
                            <input
                                type="text"
                                value={maxAge}
                                onChange={(e) => {
                                    setMaxAge(e.target.value);
                                }}
                                className="form-input"
                                placeholder="Maximum age..."
                            />
                        </div>
                    </div>
                </div> */}

                {/* ----------------------------------------------- */}

                <div className="datatables">
                    <DataTable
                        highlightOnHover
                        className="whitespace-nowrap table-hover"
                        records={recordsData}
                        style={{
                            position: 'relative',

                            zIndex: 0,
                        }}
                        columns={[
                            { accessor: 'id', title: '#', sortable: true, hidden: hideCols.includes('id') },
                            { accessor: 'AGENTNAME', title: 'Agent Name', sortable: true, hidden: hideCols.includes('agentName') },
                            { accessor: 'AFIRMNAME', title: 'Agent Firm Name', sortable: true, hidden: hideCols.includes('agentFirmName') },
                            { accessor: 'APEMAILID', title: 'Email', sortable: true, hidden: hideCols.includes('email') },
                            { accessor: 'APMOBILENO', title: 'Phone', sortable: true, hidden: hideCols.includes('phone') },
                            { accessor: 'APCOUNTRY', title: 'Country', sortable: true, hidden: hideCols.includes('APCOUNTRY') },
                            { accessor: 'APCITY', title: 'City', sortable: true, hidden: hideCols.includes('APCITY') },
                            { accessor: 'APSTATE', title: 'State', sortable: true, hidden: hideCols.includes('APSTATE') },
                            { accessor: 'APDISTRICT', title: 'District', sortable: true, hidden: hideCols.includes('APDISTRICT') },
                            { accessor: 'APADDRESSLINE1', title: 'Agent Address', sortable: true, hidden: hideCols.includes('APADDRESSLINE1') },
                            { accessor: 'APERSONALIDTYPE', title: 'Agent ID Type', sortable: true, hidden: hideCols.includes('APERSONALIDTYPE') },
                            { accessor: 'APERSONALID', title: 'Agent ID No', sortable: true, hidden: hideCols.includes('APERSONALID') },
                            { accessor: 'AACCOUNTHOLDERNAME', title: 'Account Holder Name', sortable: true, hidden: hideCols.includes('AACCOUNTHOLDERNAME') },
                            { accessor: 'AACCOUNTTYPE', title: 'Account Type', sortable: true, hidden: hideCols.includes('AACCOUNTTYPE') },
                            { accessor: 'AACCOUNTNO', title: 'Account Number', sortable: true, hidden: hideCols.includes('AACCOUNTNO') },
                            { accessor: 'ABANKNAME', title: 'Bank Name', sortable: true, hidden: hideCols.includes('ABANKNAME') },
                            { accessor: 'ABRANCHNAME', title: 'Branch Name', sortable: true, hidden: hideCols.includes('ABRANCHNAME') },
                            { accessor: 'AIFSCCODE', title: 'IFSC Code', sortable: true, hidden: hideCols.includes('AIFSCCODE') },
                            { accessor: 'AMICRCODE', title: 'MICR Code', sortable: true, hidden: hideCols.includes('AMICRCODE') },
                            { accessor: 'ACHEQUENO', title: 'Cheque No', sortable: true, hidden: hideCols.includes('ACHEQUENO') },
                            { accessor: 'ACHEQUEREMARK', title: 'Cheque Remark', sortable: true, hidden: hideCols.includes('ACHEQUEREMARK') },
                            { accessor: 'ACADDRESSLINE1', title: 'Company Address', sortable: true, hidden: hideCols.includes('ACADDRESSLINE1') },
                            { accessor: 'ACCITY', title: 'Company City', sortable: true, hidden: hideCols.includes('ACCITY') },
                            { accessor: 'ACCOUNTRY', title: 'Company Country', sortable: true, hidden: hideCols.includes('ACCOUNTRY') },
                            { accessor: 'ACDISTRICT', title: 'Company District', sortable: true, hidden: hideCols.includes('ACDISTRICT') },
                            { accessor: 'ACSTATE', title: 'Company State', sortable: true, hidden: hideCols.includes('ACSTATE') },
                            { accessor: 'ACMOBILENO', title: 'Company Contact No', sortable: true, hidden: hideCols.includes('ACMOBILENO') },
                            { accessor: 'ACTELEPHONENO', title: 'Company Telephone', sortable: true, hidden: hideCols.includes('ACTELEPHONENO') },
                            { accessor: 'ACPINCODE', title: 'Company Pincode', sortable: true, hidden: hideCols.includes('ACPINCODE') },
                            { accessor: 'CREATEDBY', title: 'Created By', sortable: true, hidden: hideCols.includes('CREATEDBY') },
                            { accessor: 'CREATEDON', title: 'Created On', sortable: true, hidden: hideCols.includes('CREATEDON') },
                            { accessor: 'REMARK', title: 'Remark', sortable: true, hidden: hideCols.includes('Remark') },
                            { accessor: 'UPDATEDBY', title: 'Updated By', sortable: true, hidden: hideCols.includes('UPDATEDBY') },
                            { accessor: 'UPDATEDON', title: 'Updated On', sortable: true, hidden: hideCols.includes('UPDATEDON') },
                            { accessor: 'STATUS', title: 'Status', sortable: true, hidden: hideCols.includes('age') },
                            {
                                accessor: 'ADOB',
                                title: 'DOB',
                                sortable: true,
                                hidden: hideCols.includes('dob'),
                                // render: ({ dob }) => <div>{formatDate(dob)}</div>,
                            },
                        ]}
                        // totalRecords={initialRecords.length}
                        totalRecords={totalRecords}
                        recordsPerPage={pageSize}
                        page={currentPage}
                        onPageChange={(p) => setCurrentPage(p)}
                        recordsPerPageOptions={PAGE_SIZES}
                        onRecordsPerPageChange={setPageSize}
                        sortStatus={sortStatus}
                        onSortStatusChange={setSortStatus}
                        minHeight={200}
                        paginationText={({ from, to, totalRecords }) => `Showing  ${from} to ${to} of ${totalRecords} entries`}
                    />
                </div>
            </div>

            <div>
            <nav
            className={`sidebar fixed min-h-screen h-full top-0 bottom-0 w-[260px] shadow-[5px_0_25px_0_rgba(94,92,154,0.1)] z-50 transition-all duration-300 ${
                semidark ? 'text-white-dark' : ''
            }`}
        >
            <div className="bg-white dark:bg-black h-full">
                <div className="flex justify-between items-center px-4 py-3">
                    <NavLink to="/" className="main-logo flex items-center shrink-0">
                        <img className="w-8 ml-[5px] flex-none" src="/assets/images/logo.png" alt="logo" />
                        <span className="text-2xl ltr:ml-1.5 rtl:mr-1.5 font-semibold align-middle lg:inline dark:text-white-light">
                            YOUR_APP_NAME
                        </span>
                    </NavLink>

                    <button
                        type="button"
                        className="collapse-icon w-8 h-8 rounded-full flex items-center hover:bg-gray-500/10 dark:hover:bg-dark-light/10 dark:text-white-light transition duration-300 rtl:rotate-180"
                        onClick={() => dispatch(toggleSidebar())}
                    >
                        <IconCaretsDown className="m-auto rotate-90" />
                    </button>
                </div>

                <PerfectScrollbar className="h-[calc(100vh-80px)] relative">
                    <ul className="relative font-semibold space-y-0.5 p-4 py-0">
                        {/* Dashboard Section */}
                        <li className="menu nav-item">
                            <button
                                type="button"
                                className={`${currentMenu === 'dashboard' ? 'active' : ''} nav-link group w-full`}
                                onClick={() => toggleMenu('dashboard')}
                            >
                                <div className="flex items-center">
                                    <IconMenuDashboard className="group-hover:!text-primary shrink-0" />
                                    <span className="ltr:pl-3 rtl:pr-3 text-black dark:text-[#506690] dark:group-hover:text-white-dark">
                                        Dashboard
                                    </span>
                                </div>
                                <div className={currentMenu !== 'dashboard' ? 'rtl:rotate-90 -rotate-90' : ''}>
                                    <IconCaretDown />
                                </div>
                            </button>

                            <AnimateHeight duration={300} height={currentMenu === 'dashboard' ? 'auto' : 0}>
                                <ul className="sub-menu text-gray-500">
                                    <li>
                                        <NavLink to="/dashboard">Overview</NavLink>
                                    </li>
                                    <li>
                                        <NavLink to="/dashboard/analytics">Analytics</NavLink>
                                    </li>
                                </ul>
                            </AnimateHeight>
                        </li>

                        {/* Main Sections */}
                        <h2 className="py-3 px-7 flex items-center uppercase font-extrabold bg-white-light/30 dark:bg-dark dark:bg-opacity-[0.08] -mx-4 mb-1">
                            <IconMinus className="w-4 h-5 flex-none hidden" />
                            <span>Main Sections</span>
                        </h2>

                        {/* Example Section with Submenus */}
                        <li className="menu nav-item">
                            <button
                                type="button"
                                className={`${currentMenu === 'reports' ? 'active' : ''} nav-link group w-full`}
                                onClick={() => toggleMenu('reports')}
                            >
                                <div className="flex items-center">
                                    <IconMenuTables className="group-hover:!text-primary shrink-0" />
                                    <span className="ltr:pl-3 rtl:pr-3 text-black dark:text-[#506690] dark:group-hover:text-white-dark">
                                        Reports
                                    </span>
                                </div>
                                <div className={currentMenu !== 'reports' ? 'rtl:rotate-90 -rotate-90' : ''}>
                                    <IconCaretDown />
                                </div>
                            </button>

                            <AnimateHeight duration={300} height={currentMenu === 'reports' ? 'auto' : 0}>
                                <ul className="sub-menu text-gray-500">
                                    <li>
                                        <button
                                            type="button"
                                            className={`${basicSubMenuOpen ? 'active' : ''} nav-link group w-full`}
                                            onClick={() => setBasicSubMenuOpen(!basicSubMenuOpen)}
                                        >
                                            <div className="flex items-center">
                                                <span className="ltr:pl-3 rtl:pr-3 text-black dark:text-[#506690] dark:group-hover:text-white-dark">
                                                    Master Reports
                                                </span>
                                            </div>
                                            <div className={basicSubMenuOpen ? '' : 'rtl:rotate-90 -rotate-90'}>
                                                <IconCaretDown />
                                            </div>
                                        </button>

                                        <AnimateHeight duration={300} height={basicSubMenuOpen ? 'auto' : 0}>
                                            <ul className="sub-menu text-gray-500">
                                                <li>
                                                    <NavLink to="/reports/master/users">User Report</NavLink>
                                                </li>
                                                <li>
                                                    <NavLink to="/reports/master/products">Product Report</NavLink>
                                                </li>
                                            </ul>
                                        </AnimateHeight>
                                    </li>
                                    <li>
                                        <button
                                            type="button"
                                            className={`${purchaseSubMenuOpen ? 'active' : ''} nav-link group w-full`}
                                            onClick={() => setPurchaseSubMenuOpen(!purchaseSubMenuOpen)}
                                        >
                                            <div className="flex items-center">
                                                <span className="ltr:pl-3 rtl:pr-3 text-black dark:text-[#506690] dark:group-hover:text-white-dark">
                                                    Purchase Reports
                                                </span>
                                            </div>
                                            <div className={purchaseSubMenuOpen ? '' : 'rtl:rotate-90 -rotate-90'}>
                                                <IconCaretDown />
                                            </div>
                                        </button>

                                        <AnimateHeight duration={300} height={purchaseSubMenuOpen ? 'auto' : 0}>
                                            <ul className="sub-menu text-gray-500">
                                                <li>
                                                    <NavLink to="/reports/purchase/summary">Purchase Summary</NavLink>
                                                </li>
                                                <li>
                                                    <NavLink to="/reports/purchase/detail">Purchase Detail</NavLink>
                                                </li>
                                            </ul>
                                        </AnimateHeight>
                                    </li>
                                </ul>
                            </AnimateHeight>
                        </li>

                        {/* Simple Menu Items */}
                        <li className="menu nav-item">
                            <NavLink to="/settings" className="group">
                                <div className="flex items-center">
                                    <IconMenuTables className="group-hover:!text-primary shrink-0" />
                                    <span className="ltr:pl-3 rtl:pr-3 text-black dark:text-[#506690] dark:group-hover:text-white-dark">
                                        Settings
                                    </span>
                                </div>
                            </NavLink>
                        </li>

                        {/* User Section */}
                        <h2 className="py-3 px-7 flex items-center uppercase font-extrabold bg-white-light/30 dark:bg-dark dark:bg-opacity-[0.08] -mx-4 mb-1">
                            <IconMinus className="w-4 h-5 flex-none hidden" />
                            <span>User</span>
                        </h2>

                        <li className="menu nav-item">
                            <NavLink to="/profile" className="group">
                                <div className="flex items-center">
                                    <IconMenuTables className="group-hover:!text-primary shrink-0" />
                                    <span className="ltr:pl-3 rtl:pr-3 text-black dark:text-[#506690] dark:group-hover:text-white-dark">
                                        My Profile
                                    </span>
                                </div>
                            </NavLink>
                        </li>

                        <li className="menu nav-item">
                            <NavLink to="/logout" className="group">
                                <div className="flex items-center">
                                    <IconMenuTables className="group-hover:!text-primary shrink-0" />
                                    <span className="ltr:pl-3 rtl:pr-3 text-black dark:text-[#506690] dark:group-hover:text-white-dark">
                                        Logout
                                    </span>
                                </div>
                            </NavLink>
                        </li>
                    </ul>
                </PerfectScrollbar>
            </div>
        </nav>
            </div>
        </div>
    );
};

export default StockReport;

{
    /* <div className="max-h-60 overflow-y-auto border border-gray-300 p-2">
  <table className="w-full border-collapse">
    <thead>
      <tr>
        <th className="text-left p-2 font-bold">Form Data</th>
        <th className="text-left p-2 font-bold">Select</th>
      </tr>
    </thead>
    <tbody className="overflow-y-auto block max-h-60">
      {formDatas.map((item, ind) => (
        <tr key={ind} className="flex justify-between p-2 border-b">
          <td className="font-bold">{item}</td>
          <td>
            <select
              name={item}
              className="w-[100px] ml-1 border border-gray-300 rounded"
              value={selectedFirm}
              onChange={handleDropdownChange}
            >
              <option value="">--ALL--</option>
              {initialRecords.map((record, index) => (
                <option key={index} value={record.AFIRMNAME}>
                  {record.AFIRMNAME}
                </option>
              ))}
            </select>
          </td>
        </tr>
      ))}
    </tbody>
  </table>
</div> */
}
